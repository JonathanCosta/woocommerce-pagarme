!function(e){"use strict";e(function(){var a=!1;function r(r){var n=null;if(a)return void 0!==r&&void 0!==r.data&&(void 0===r.data.preservePagarmeCheckoutSubmitValue||r.data.preservePagarmeCheckoutSubmitValue||(a=!1)),!0;if(!e("#payment_method_pagarme-credit-card").is(":checked"))return!0;if(0<e("input[name=pagarme_checkout_token]").length)return!0;if(1===e("input#terms").length&&0===e("input#terms:checked").length)return!0;if(e("#createaccount").is(":checked")&&e("#account_password").length&&""===e("#account_password").val())return!0;if((n=e("#ship-to-different-address-checkbox").is(":checked")?e(".woocommerce-billing-fields .validate-required, .woocommerce-shipping-fields .validate-required"):e(".woocommerce-billing-fields .validate-required")).length){var t=!1;if(0<e("#billing_persontype").length?(n.each(function(){""===e(this).find("input.input-text, select").not(e("#account_password, #account_username, #billing_cpf, #billing_rg, #billing_cnpj, #billing_company, #billing_ie")).val()&&(t=!0)}),t||(t=function(){var a=!1;return"1"===e("#billing_persontype").val()?e("#billing_cpf, #billing_rg").each(function(){""===e(this).val()&&(a=!0)}):"2"===e("#billing_persontype").val()&&e("#billing_cnpj, #billing_company, #billing_ie").each(function(){""===e(this).val()&&(a=!0)}),a}())):n.each(function(){""===e(this).find("input.input-text, select").not(e("#account_password, #account_username")).val()&&(t=!0)}),t)return!0}return!1}function n(e){return 0<e.length}function t(e){return e.replace(/[^\d]/g,"")}function i(){if(r())return!0;var i,l,c,o=e("form.checkout, form#order_review"),s=e("#pagarme-checkout-params",o);i=new PagarMeCheckout.Checkout({encryption_key:wcPagarmeParams.encryptionKey,success:function(r){a=!0,"no"===wcPagarmeParams.register_refused_order?(e("input[name=pagarme_checkout_token]",o).remove(),o.append(e('<input name="pagarme_checkout_token" type="hidden" />').val(r.token))):(e("input[name=pagarme_card_hash]",o).remove(),e("input[name=pagarme_installments]",o).remove(),o.append(e('<input name="pagarme_card_hash" type="hidden" />').val(r.card_hash)),o.append(e('<input name="pagarme_installments" type="hidden" />').val(r.installments))),o.submit()}}),l=wcPagarmeParams.checkoutPayPage?wcPagarmeParams.customerFields:function(a){var r,i={};return i.customerName=e.trim(e("#billing_first_name",a).val()+" "+e("#billing_last_name",a).val()),i.customerEmail=e("#billing_email",a).val(),n(e("#billing_address_1"))&&(i.customerAddressStreet=e("#billing_address_1").val(),i.customerAddressCity=e("#billing_city").val(),i.customerAddressState=e("#billing_state").val(),i.customerAddressComplementary=e("#billing_address_2").val(),i.customerAddressZipcode=t(e("#billing_postcode").val()),n(e("#billing_number"))&&(i.customerAddressStreetNumber=e("#billing_number").val()),n(e("#billing_neighborhood"))&&(i.customerAddressNeighborhood=e("#billing_neighborhood").val())),n(e("#billing_phone"))&&(r=t(e("#billing_phone").val()),i.customerPhoneDdd=r.substr(0,2),i.customerPhoneNumber=r.substr(2)),n(e("#billing_persontype"))?"1"===e("#billing_persontype").val()?i.customerDocumentNumber=t(e("#billing_cpf").val()):(i.customerName=e("#billing_company").val(),i.customerDocumentNumber=t(e("#billing_cnpj").val())):n(e("#billing_cpf"))?i.customerDocumentNumber=t(e("#billing_cpf").val()):n(e("#billing_cnpj"))&&(i.customerName=e("#billing_company").val(),i.customerDocumentNumber=t(e("#billing_cnpj").val())),i}(o);const m="yes"===wcPagarmeParams.register_refused_order?"false":"true";return c=e.extend({},{paymentMethods:"credit_card",customerData:!1,amount:s.data("total"),createToken:m,interestRate:wcPagarmeParams.interestRate,maxInstallments:s.data("max_installment"),freeInstallments:wcPagarmeParams.freeInstallments,postbackUrl:wcPagarmeParams.postbackUrl,uiColor:wcPagarmeParams.uiColor},l),i.open(c),!1}e("form.checkout").on("click","#place_order",function(){return i()}),e("form.checkout").on("checkout_place_order_pagarme-credit-card",{preservePagarmeCheckoutSubmitValue:!0},r),e("form#order_review").submit(function(){return i()})})}(jQuery);